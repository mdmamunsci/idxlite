"use strict";(self["webpackChunkannual_report"]=self["webpackChunkannual_report"]||[]).push([[163],{62163:function(e,a,t){t.r(a),t.d(a,{default:function(){return Q}});t(18111),t(22489);var l=t(56768),o=t(45130),s=t(24232),n=t(41533),u=t(56278),c=t(62510),i=t(90144);const r={class:"min-h-screen bg-gray-50"},d={class:"container mx-auto p-6"},v={key:0,class:"flex items-center justify-center py-20"},p={key:1,class:"mx-auto"},g={class:"flex flex-wrap gap-4 mb-4 items-center"},y={class:"w-full table-auto bg-white rounded-xl shadow overflow-hidden"},k={class:"py-3 px-6"},b={class:"py-3 px-6 font-semibold"},x={class:"py-3 px-6"},f={class:"py-3 px-6"},L={class:"py-3 px-6"},h={class:"py-3 px-6 flex gap-2"},m=["onClick"],w=["onClick"],C={class:"pagination"},_=["disabled"],K=["disabled"],A={key:0,class:"text-center text-gray-500 mt-6"},R={key:2,class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},E={class:"bg-white rounded-xl shadow p-6 w-full max-w-md"},X={class:"flex flex-col gap-3"},S={class:"flex items-center gap-2"},j={key:3,class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},U={class:"bg-white rounded-xl shadow p-6 w-full max-w-md"},V={class:"flex flex-col gap-3"},D={class:"flex items-center gap-2"},J={key:4,class:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"},N={class:"bg-white rounded-xl shadow p-6 w-full max-w-sm"};var F={__name:"CategoryPage",setup(e){const a=(0,i.KR)([]),t=(0,i.KR)(!1),F=(0,i.KR)(1),I=(0,i.KR)(5),W=(0,i.KR)(1),Q=(0,i.KR)(0),P=(0,c.L)();async function z(e){const t=e?.new_data,l=e?.prev_data;if(1===Q.value)return;if("delete"===e.operation_type){await u.X.remove(l.uuid);try{const e=await n.c.getAll(F.value,I.value);W.value=e.total||1,a.value=e.data||[]}catch(s){console.log("error: ",s)}}if(!t)return;await u.X.processQueueSave(t);const o=a.value.findIndex(e=>e.id===t.id);-1!==o?a.value[o]={...a.value[o],...t}:(a.value.unshift(t),a.value.length>I.value&&a.value.pop())}const H=async()=>{t.value=!0;try{const e=await n.c.getAll(F.value,I.value);W.value=e.total||1,a.value=e.data||[]}catch(e){console.error("API error:",e),a.value=[]}finally{t.value=!1}},O=()=>{F.value<W.value&&F.value++},B=()=>{F.value>1&&F.value--};(0,l.sV)(async()=>{await H(),P.on("category",z)}),(0,l.wB)(F,H),(0,l.hi)(()=>{P.off("category",z)});const M=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),T=(0,i.KR)(""),q=(0,i.KR)(""),G=(0,l.EW)(()=>a.value.filter(e=>{const a=e.name.toLowerCase().includes(T.value.toLowerCase()),t=""===q.value||("active"===q.value?e.is_active:!e.is_active);return a&&t})),Y=(0,i.KR)(!1),Z=(0,i.KR)({name:"",description:"",is_active:!0}),$=()=>{Z.value={name:"",description:"",is_active:!0},Y.value=!0},ee=()=>{Y.value=!1},ae=async()=>{try{Q.value=1;const e=await n.c.create(Z.value);e?(await H(),ee(),Q.value=0):(Q.value=0,alert("Failed to add category: "+JSON.stringify(e)))}catch(e){Q.value=0,alert("Failed to add category: "+e.message)}},te=(0,i.KR)(!1),le=(0,i.KR)({}),oe=e=>{le.value={...e},te.value=!0},se=()=>{te.value=!1},ne=async()=>{try{Q.value=1;const e=await n.c.update(le.value.uuid,{name:le.value.name,description:le.value.description,is_active:le.value.is_active});e?(await H(),se(),Q.value=0):(Q.value=0,alert("Failed to add category: "+JSON.stringify(e.data)))}catch(e){Q.value=0,alert("Failed to update category: "+e.message)}},ue=(0,i.KR)(!1),ce=(0,i.KR)({}),ie=e=>{ce.value=e,ue.value=!0},re=()=>{ue.value=!1},de=async()=>{try{Q.value=1;const e=await n.c.delete(ce.value.uuid);if(e)await H(),re(),Q.value=0;else{const a=await e.json();Q.value=0,alert("Failed to delete category: "+JSON.stringify(a))}}catch(e){Q.value=0,alert("Failed to delete category: "+e.message)}};return(e,a)=>((0,l.uX)(),(0,l.CE)("div",r,[(0,l.Lk)("div",d,[t.value?((0,l.uX)(),(0,l.CE)("div",v,a[8]||(a[8]=[(0,l.Lk)("div",{class:"flex items-center gap-3"},[(0,l.Lk)("div",{class:"animate-spin rounded-full h-6 w-6 border-b-2 border-[#e53935]"}),(0,l.Lk)("span",{class:"text-gray-700 font-medium"},"Loading categories...")],-1)]))):((0,l.uX)(),(0,l.CE)("div",p,[a[12]||(a[12]=(0,l.Lk)("h2",{class:"text-3xl font-bold text-[#e53935] mb-6 text-left"},"Category List",-1)),(0,l.Lk)("div",g,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>T.value=e),type:"text",placeholder:"Search categories...",class:"border border-gray-300 rounded-lg px-4 py-2 w-full md:w-1/3 focus:outline-none focus:ring-2 focus:ring-[#e53935] placeholder-gray-400"},null,512),[[o.Jo,T.value]]),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":a[1]||(a[1]=e=>q.value=e),class:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[#e53935]"},a[9]||(a[9]=[(0,l.Lk)("option",{value:""},"All Status",-1),(0,l.Lk)("option",{value:"active"},"Active",-1),(0,l.Lk)("option",{value:"inactive"},"Inactive",-1)]),512),[[o.u1,q.value]]),(0,l.Lk)("button",{onClick:$,class:"ml-auto bg-[#5c6ac4] text-white px-4 py-2 rounded-lg hover:bg-[#4855a3] flex items-center gap-2"},a[10]||(a[10]=[(0,l.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(0,l.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),(0,l.eW)(" Add Category ",-1)]))]),(0,l.Lk)("table",y,[a[11]||(a[11]=(0,l.Lk)("thead",{class:"bg-gray-200 text-gray-700"},[(0,l.Lk)("tr",null,[(0,l.Lk)("th",{class:"py-3 px-6"},"#"),(0,l.Lk)("th",{class:"py-3 px-6"},"Title"),(0,l.Lk)("th",{class:"py-3 px-6"},"Description"),(0,l.Lk)("th",{class:"py-3 px-6"},"Status"),(0,l.Lk)("th",{class:"py-3 px-6"},"Created"),(0,l.Lk)("th",{class:"py-3 px-6"},"Actions")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(G.value,e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.uuid,class:"border-b hover:bg-[#fff0f0] transition"},[(0,l.Lk)("td",k,(0,s.v_)(e.id),1),(0,l.Lk)("td",b,(0,s.v_)(e.name),1),(0,l.Lk)("td",x,(0,s.v_)(e.description),1),(0,l.Lk)("td",f,[(0,l.Lk)("span",{class:(0,s.C4)(e.is_active?"text-green-600":"text-gray-400")},(0,s.v_)(e.is_active?"Active":"Inactive"),3)]),(0,l.Lk)("td",L,(0,s.v_)(M(e.created_at)),1),(0,l.Lk)("td",h,[(0,l.Lk)("button",{onClick:a=>oe(e),class:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600"}," Edit ",8,m),(0,l.Lk)("button",{onClick:a=>ie(e),class:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600"}," Delete ",8,w)])]))),128))])]),(0,l.Lk)("div",C,[(0,l.Lk)("button",{onClick:B,disabled:1===F.value},"Previous",8,_),(0,l.Lk)("span",null,"Page "+(0,s.v_)(F.value)+" of "+(0,s.v_)(W.value),1),(0,l.Lk)("button",{onClick:O,disabled:F.value===W.value},"Next",8,K)]),0===G.value.length?((0,l.uX)(),(0,l.CE)("div",A," No categories found. ")):(0,l.Q3)("",!0)])),Y.value?((0,l.uX)(),(0,l.CE)("div",R,[(0,l.Lk)("div",E,[a[14]||(a[14]=(0,l.Lk)("h3",{class:"text-xl font-bold text-[#5c6ac4] mb-4"},"Add New Category",-1)),(0,l.Lk)("div",X,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>Z.value.name=e),placeholder:"Name",class:"border rounded px-3 py-2 focus:outline-none"},null,512),[[o.Jo,Z.value.name]]),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":a[3]||(a[3]=e=>Z.value.description=e),placeholder:"Description",class:"border rounded px-3 py-2 focus:outline-none"},null,512),[[o.Jo,Z.value.description]]),(0,l.Lk)("label",S,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=e=>Z.value.is_active=e)},null,512),[[o.lH,Z.value.is_active]]),a[13]||(a[13]=(0,l.eW)(" Active ",-1))])]),(0,l.Lk)("div",{class:"flex justify-end gap-3 mt-4"},[(0,l.Lk)("button",{onClick:ee,class:"px-4 py-2 rounded bg-gray-300 hover:bg-gray-400"}," Cancel "),(0,l.Lk)("button",{onClick:ae,class:"px-4 py-2 rounded bg-[#5c6ac4] text-white hover:bg-[#4855a3]"}," Add ")])])])):(0,l.Q3)("",!0),te.value?((0,l.uX)(),(0,l.CE)("div",j,[(0,l.Lk)("div",U,[a[16]||(a[16]=(0,l.Lk)("h3",{class:"text-xl font-bold text-[#e53935] mb-4"},"Edit Category",-1)),(0,l.Lk)("div",V,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":a[5]||(a[5]=e=>le.value.name=e),placeholder:"Name",class:"border rounded px-3 py-2 focus:outline-none"},null,512),[[o.Jo,le.value.name]]),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":a[6]||(a[6]=e=>le.value.description=e),placeholder:"Description",class:"border rounded px-3 py-2 focus:outline-none"},null,512),[[o.Jo,le.value.description]]),(0,l.Lk)("label",D,[(0,l.bo)((0,l.Lk)("input",{type:"checkbox","onUpdate:modelValue":a[7]||(a[7]=e=>le.value.is_active=e)},null,512),[[o.lH,le.value.is_active]]),a[15]||(a[15]=(0,l.eW)(" Active ",-1))])]),(0,l.Lk)("div",{class:"flex justify-end gap-3 mt-4"},[(0,l.Lk)("button",{onClick:se,class:"px-4 py-2 rounded bg-gray-300 hover:bg-gray-400"}," Cancel "),(0,l.Lk)("button",{onClick:ne,class:"px-4 py-2 rounded bg-[#e53935] text-white hover:bg-[#c62828]"}," Save ")])])])):(0,l.Q3)("",!0),ue.value?((0,l.uX)(),(0,l.CE)("div",J,[(0,l.Lk)("div",N,[a[19]||(a[19]=(0,l.Lk)("h3",{class:"text-xl font-bold text-[#e53935] mb-4"},"Delete Category",-1)),(0,l.Lk)("p",null,[a[17]||(a[17]=(0,l.eW)(" Are you sure you want to delete ",-1)),(0,l.Lk)("strong",null,(0,s.v_)(ce.value.name),1),a[18]||(a[18]=(0,l.eW)("? ",-1))]),(0,l.Lk)("div",{class:"flex justify-end gap-3 mt-4"},[(0,l.Lk)("button",{onClick:re,class:"px-4 py-2 rounded bg-gray-300 hover:bg-gray-400"}," Cancel "),(0,l.Lk)("button",{onClick:de,class:"px-4 py-2 rounded bg-red-500 text-white hover:bg-red-600"}," Delete ")])])])):(0,l.Q3)("",!0)])]))}},I=t(71241);const W=(0,I.A)(F,[["__scopeId","data-v-1e9ad26a"]]);var Q=W}}]);
//# sourceMappingURL=163.3b7b5845.js.map